<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Map</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-openweathermap/leaflet-openweathermap.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-openweathermap/leaflet-openweathermap.js"></script>
    <script th:src="@{/js/map.js}"></script>
</head>

<body>
    <header>
        <h1>Property-Versatile</h1>
    </header>

    <nav>
        <a th:href="@{/index}">Home</a>
        <a th:href="@{/properties}">Properties</a>
        <a th:href="@{/maintenance}">Maintenance Requests</a>
        <a th:href="@{/weather}">Weather</a>
        <a th:href="@{/engineers}">Engineers</a>
    </nav>

    <div id="map" style="height: 600px;"></div>

    <script>
        var map;

        function initMap() {
            // Your OpenWeatherMap API key
            var apiKey = '7329adde15660656920342e78257e068';

            // Updated OpenWeatherMap layer URL for PARAIN
            var parainLayerUrl = 'https://maps.openweathermap.org/maps/2.0/weather/1h/PARAIN/{z}/{x}/{y}?date=1618898990&appid=' + apiKey;

            // New OpenWeatherMap layer URL for temp_new
            var tempNewLayerUrl = 'https://maps.openweathermap.org/maps/2.0/weather/1h/temp_new/{z}/{x}/{y}?appid=' + apiKey;

            // Create the map with an initial location and zoom level
            map = L.map('map').setView([51.58, 10.1], 6);

            // Add the OpenStreetMap layer as a base map
            var osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors'
            }).addTo(map);

            // Add the OpenWeatherMap layers as overlays
            var parainLayer = L.tileLayer(parainLayerUrl, {
                maxZoom: 19,
                attribution: 'Weather data &copy; <a href="https://openweathermap.org/" target="_blank">OpenWeatherMap</a>'
            });

            var tempNewLayer = L.tileLayer(tempNewLayerUrl, {
                maxZoom: 19,
                attribution: 'Weather data &copy; <a href="https://openweathermap.org/" target="_blank">OpenWeatherMap</a>'
            });

            // Create a layer control for switching between base and overlay maps
            var baseMaps = {
                'OpenStreetMap': osmLayer
            };

            var overlayMaps = {
                'PARAIN Map': parainLayer,
                'temp_new Map': tempNewLayer
            };

            L.control.layers(baseMaps, overlayMaps).addTo(map);
        }

        // Call the initMap function when the page has finished loading
        document.addEventListener('DOMContentLoaded', initMap);
    </script>
</body>

</html>